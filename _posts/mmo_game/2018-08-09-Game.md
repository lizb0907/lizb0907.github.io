---
layout: post
title: java游戏服务端，mmo game
categories: Mmo_Game
description: 记录一些mmo game游戏服务端相关开发，java游戏服务端
keywords: java游戏服务端，mmo，game
---

主要是日常工作中关于java游戏服务器开发积累



**目录**

* TOC
{:toc}

## 生活技能开发积累


### 1.Collections.sort(list)方法时，如果list是不可修改的，将报不可操作错误

```java
public static void main( String[] args )
{
    List<Integer> list = new ArrayList<>();
    list.add(1);
    list.add(2);
    list.add(3);
    //将list变为不可修改
    List<Integer> unModifiableList = Collections.unmodifiableList(list);
    test(unModifiableList);
}

private static void test(List<Integer> list)
{
    //对不可修改的list进行排序，将报错
    Collections.sort(list);

    for (int v : list)
    {
        System.out.println(v);
    }
}
```
结果：
```java
Exception in thread "main" java.lang.UnsupportedOperationException
 at java.util.Collections$UnmodifiableList.sort(Collections.java:1331)
 at java.util.Collections.sort(Collections.java:141)
 at com.lzb.App.test(App.java:38)
 at com.lzb.App.main(App.java:32)
```

游戏开发:

```java
// 生活技能合成操作 (烹饪、制药、熔矿)
message CSAbilityComposeOperate {
    required int32 abilityId = 1; // 生活技能id
    optional int32 composeId = 2; // 配方id(制药、熔矿、烹饪)
    required int32 composeNum = 3; // 合成数量
    required int32 useItemType = 4; // 使用材料类型 1 先绑定后非绑 2 只绑定 3 只非绑
    required int32 panEditorId = 5; // 烹饪锅的id
    optional bool useOptionalItem = 6; // 是否使用高级材料
    repeated int32 cookItems = 7; // 烹饪消耗食材列表
}
```
用protobuf时，例如repeated int32 cookItems = 7，服务器接受时默认是一个不可修改的list, 
所以我们可以先将list转成可修改的list，然后再调用Collections.sort()给list排序，就不会报错了。

```java
//转为可修改的list，再调用sort方法
List<Integer> modifiableList = new ArrayList<>(unmodifiableList);
Collections.sort(modifiableList);
```

### 2.jdk原生HashMap在get的时候，如果键值对没匹配到，那么返回的是null值

```java
HashMap<String, Integer> map1 = new HashMap<>();
map1.put("lzb", 100);

HashMap<Integer, Integer> map2 = new HashMap<>();
map2.put(1, 1);

System.out.println(map1.get("swf"));
System.out.println(map2.get(2));
```
结果:
```java
null
null
```

项目使用的trov4j里的 TIntIntHashMap如果key值没匹配上，那么返回是0

```java
TIntIntHashMap map3 = new TIntIntHashMap();
map3.put(1, 1);
System.out.println(map3.get(2));
```
结果:
```java
0
```
